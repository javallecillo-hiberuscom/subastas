<div class="notificaciones-container">
  <div class="header">
    <h1>üîî Notificaciones Administrativas</h1>
    <div class="header-actions">
      <div class="badge-contador" *ngIf="contadorNoLeidas() > 0">
        {{ contadorNoLeidas() }} sin leer
      </div>
      <button class="btn-action" (click)="marcarTodasLeidas()" *ngIf="contadorNoLeidas() > 0">
        ‚úì Marcar todas le√≠das
      </button>
      <button class="btn-action" (click)="limpiarLeidas()">
        üóëÔ∏è Limpiar le√≠das
      </button>
    </div>
  </div>

  <div class="filtros">
    <button 
      class="filtro-btn"
      [class.active]="filtro() === 'no-leidas'"
      (click)="cambiarFiltro('no-leidas')">
      Sin leer ({{ contadorNoLeidas() }})
    </button>
    <button 
      class="filtro-btn"
      [class.active]="filtro() === 'todas'"
      (click)="cambiarFiltro('todas')">
      Todas
    </button>
  </div>

  @if (loading()) {
    <div class="loading">
      <div class="spinner"></div>
      <p>Cargando notificaciones...</p>
    </div>
  } @else if (notificaciones().length === 0) {
    <div class="empty-state">
      <span class="empty-icon">üì≠</span>
      <p>No hay notificaciones</p>
    </div>
  } @else {
    <div class="notificaciones-lista">
      @for (notif of notificaciones(); track notif.IdNotificacion) {
        <div class="notificacion-card" [class.no-leida]="notif.Leida === 0" [class]="getTipoClase(notif.Tipo)">
          <div class="notif-icono">
            <span>{{ getTipoIcono(notif.Tipo) }}</span>
          </div>
          
          <div class="notif-contenido">
            <div class="notif-header">
              <h3>{{ notif.Titulo }}</h3>
              <span class="notif-fecha">{{ getFormattedDate(notif.FechaCreacion) }}</span>
            </div>
            
            <p class="notif-mensaje">{{ notif.Mensaje }}</p>
            
            @if (notif.Usuario) {
              <div class="notif-usuario">
                <span class="usuario-tag" (click)="navegarAUsuario(notif.IdUsuario)">
                  üë§ {{ notif.Usuario.Nombre }} {{ notif.Usuario.Apellidos }}
                  <small>({{ notif.Usuario.Email }})</small>
                </span>
              </div>
            }
          </div>
          
          <div class="notif-acciones">
            @if (notif.Leida === 0) {
              <button 
                class="btn-mini" 
                (click)="marcarComoLeida(notif)"
                title="Marcar como le√≠da">
                ‚úì
              </button>
            }
            <button 
              class="btn-mini btn-delete" 
              (click)="eliminarNotificacion(notif)"
              title="Eliminar">
              ‚úï
            </button>
          </div>
        </div>
      }
    </div>
  }
</div>
