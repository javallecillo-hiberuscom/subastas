<div class="subir-iae-container">
  <div class="card">
    <div class="card-header">
      <h2>üìÑ Subir Documento IAE</h2>
      <p>Para poder realizar pujas, debes subir tu documento de Impuesto de Actividades Econ√≥micas (IAE)</p>
    </div>

    @if (estadoValidacion()) {
      <div class="estado-actual" [ngClass]="getEstadoClass()">
        <p>{{ getEstadoMensaje() }}</p>
      </div>
    }

    <div class="card-body">
      @if (!estadoValidacion()?.validado) {
        <div class="upload-section">
          @if (estadoValidacion()?.tieneDocumento) {
            <div class="aviso-reemplazar">
              <p>‚ö†Ô∏è Ya has subido un documento previamente. Si subes uno nuevo, reemplazar√° al anterior.</p>
            </div>
          }
          
          <div class="drop-zone"
               [class.drag-over]="dragOver()"
               (dragover)="onDragOver($event)"
               (dragleave)="onDragLeave($event)"
               (drop)="onDrop($event)">
            <div class="drop-zone-content">
              <span class="drop-icon">üìÅ</span>
              <p class="drop-text">Arrastra tu archivo aqu√≠ o haz clic para seleccionar</p>
              <p class="drop-hint">PDF, JPG o PNG (m√°x. 10MB)</p>
            </div>
            <input 
              type="file" 
              id="fileInput" 
              class="file-input-hidden"
              (change)="onFileSelected($event)"
              accept=".pdf,.jpg,.jpeg,.png"
              [disabled]="cargando()">
          </div>

          @if (archivoSeleccionado()) {
            <div class="archivo-info">
              <div class="archivo-detalle">
                <span class="archivo-nombre">{{ archivoSeleccionado()!.name }}</span>
                <span class="archivo-tamano">
                  {{ (archivoSeleccionado()!.size / 1024 / 1024).toFixed(2) }} MB
                </span>
              </div>
              <button 
                class="btn-limpiar" 
                (click)="limpiarArchivo()"
                [disabled]="cargando()">
                ‚úï
              </button>
            </div>
          }

          <div class="acciones">
            <button 
              class="btn-subir" 
              (click)="subirDocumento()"
              [disabled]="!archivoSeleccionado() || cargando()">
              @if (cargando()) {
                <span class="spinner"></span>
                Subiendo...
              } @else {
                üì§ Subir Documento
              }
            </button>
            @if (!archivoSeleccionado() && !cargando()) {
              <p class="hint-text">Selecciona un archivo para habilitar el bot√≥n</p>
            }
          </div>
        </div>

        <div class="info-section">
          <h3>‚ÑπÔ∏è Informaci√≥n importante</h3>
          <ul>
            <li>El documento debe estar en formato PDF o imagen (JPG, PNG)</li>
            <li>El tama√±o m√°ximo permitido es 10MB</li>
            <li>El documento ser√° revisado por un administrador</li>
            <li>Recibir√°s una notificaci√≥n cuando tu cuenta sea validada</li>
            <li>Mientras tu cuenta no est√© validada, no podr√°s realizar pujas</li>
          </ul>
        </div>
      } @else {
        <div class="validado-section">
          <div class="validado-icon">‚úÖ</div>
          <h3>¬°Tu cuenta est√° validada!</h3>
          <p>Ya puedes participar en las subastas y realizar pujas.</p>
          <a routerLink="/subastas" class="btn-ir-subastas">Ver Subastas</a>
        </div>
      }
    </div>
  </div>
</div>
